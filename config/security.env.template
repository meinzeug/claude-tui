# Security Configuration Template for Claude-TUI
# Copy this file to .env and update with your secure values

# =============================================================================
# JWT AUTHENTICATION SETTINGS
# =============================================================================

# CRITICAL: Generate a strong secret key using: openssl rand -base64 32
JWT_SECRET_KEY=CHANGE_ME_TO_SECURE_RANDOM_32_CHAR_STRING

# JWT algorithm (recommended: HS256)
JWT_ALGORITHM=HS256

# Token expiration times (in minutes for access, days for refresh)
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# JWT issuer and audience
JWT_ISSUER=claude-tui
JWT_AUDIENCE=claude-tui-api

# =============================================================================
# APPLICATION SECRETS
# =============================================================================

# CRITICAL: Generate using: openssl rand -base64 32
SECRET_KEY=CHANGE_ME_TO_SECURE_RANDOM_32_CHAR_STRING

# Encryption key for sensitive data
ENCRYPTION_KEY=CHANGE_ME_TO_SECURE_RANDOM_32_CHAR_STRING

# CSRF protection secret
CSRF_SECRET_KEY=CHANGE_ME_TO_SECURE_RANDOM_32_CHAR_STRING

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database URL (PostgreSQL recommended for production)
DATABASE_URL=postgresql://claude_tui:SECURE_PASSWORD@localhost:5432/claude_tui_prod

# Database connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis URL for sessions, cache, and token blacklist
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=SECURE_REDIS_PASSWORD

# Redis databases (use different numbers for different purposes)
REDIS_SESSION_DB=1
REDIS_AUDIT_DB=2
REDIS_RATELIMIT_DB=3
REDIS_BLACKLIST_DB=4

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================

# SMTP settings for email notifications
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_USERNAME=your-email@domain.com
SMTP_PASSWORD=YOUR_SECURE_SMTP_PASSWORD
SMTP_USE_TLS=true
SMTP_USE_SSL=false

# Email addresses
FROM_EMAIL=noreply@your-domain.com
FROM_NAME=Claude-TUI
SUPPORT_EMAIL=support@your-domain.com

# =============================================================================
# OAUTH PROVIDERS (Optional)
# =============================================================================

# GitHub OAuth
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_REDIRECT_URI=https://your-domain.com/auth/github/callback

# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=https://your-domain.com/auth/google/callback

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=production

# Debug mode (MUST be false in production)
DEBUG=false

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=your-domain.com,*.your-domain.com

# CORS origins (comma-separated)
CORS_ORIGINS=https://your-domain.com,https://app.your-domain.com

# Trusted proxies (comma-separated CIDR blocks)
TRUSTED_PROXIES=127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limits per minute
LOGIN_RATE_LIMIT=5
API_RATE_LIMIT_AUTHENTICATED=1000
API_RATE_LIMIT_ANONYMOUS=100
PASSWORD_RESET_RATE_LIMIT=3

# =============================================================================
# TWO-FACTOR AUTHENTICATION
# =============================================================================

# Enable 2FA (recommended for production)
TWO_FACTOR_ENABLED=true
TOTP_ISSUER=Claude-TUI

# =============================================================================
# AUDIT LOGGING
# =============================================================================

# Audit log configuration
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_FILE=/var/log/claude-tui/audit.log
AUDIT_MAX_FILE_SIZE_MB=100
AUDIT_BACKUP_COUNT=10
AUDIT_RETENTION_DAYS=90

# Syslog configuration (optional)
AUDIT_SYSLOG=false
SYSLOG_ADDRESS=/dev/log

# Security alert webhook (optional)
SECURITY_ALERT_WEBHOOK=https://your-monitoring-service.com/webhook

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# SSL certificate paths (if not using reverse proxy)
SSL_CERT_PATH=/path/to/ssl/certificate.crt
SSL_KEY_PATH=/path/to/ssl/private.key
SSL_CA_PATH=/path/to/ssl/ca-bundle.crt

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# API keys for external services (if used)
OPENAI_API_KEY=your_openai_api_key
CLAUDE_API_KEY=your_claude_api_key

# =============================================================================
# MONITORING AND METRICS
# =============================================================================

# Metrics collection
ENABLE_METRICS=true
METRICS_PORT=9090

# Health check settings
HEALTH_CHECK_INTERVAL=30

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Backup settings
ENABLE_AUTO_BACKUP=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=/var/backups/claude-tui

# S3 backup settings (optional)
BACKUP_S3_BUCKET=your-backup-bucket
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-west-2

# =============================================================================
# SECURITY HEADERS
# =============================================================================

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: https:
CSP_FONT_SRC='self' https:
CSP_CONNECT_SRC='self' https:

# HSTS settings
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature toggles
ENABLE_REGISTRATION=true
ENABLE_PASSWORD_RESET=true
ENABLE_SOCIAL_LOGIN=true
ENABLE_API_DOCS=false
ENABLE_ADMIN_PANEL=true

# =============================================================================
# DEVELOPMENT SETTINGS (Remove in production)
# =============================================================================

# Frontend URL for development CORS
FRONTEND_URL=http://localhost:3000

# Test database URL
TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost:5432/test_claude_tui

# Test JWT secret (different from production)
JWT_SECRET_KEY_TEST=test_jwt_secret_key_32_chars_long_123456